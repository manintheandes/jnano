<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>jllm — The Journey</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #000; --surface: #0a0a0a; --card: #111; --border: #1f1f1f;
    --text: #fff; --text-2: #999; --text-3: #555;
    --accent: #a855f7; --accent2: #ec4899; --green: #22c55e; --blue: #3b82f6;
    --mono: 'JetBrains Mono', monospace; --sans: 'Inter', sans-serif;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { width: 100%; height: 100%; overflow: hidden; }
  body { background: var(--bg); color: var(--text); font-family: var(--sans); -webkit-font-smoothing: antialiased; }

  /* ── Scenes ── */
  .scene {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    opacity: 0; transition: opacity 0.8s ease; pointer-events: none; padding: 40px;
  }
  .scene.active { opacity: 1; pointer-events: auto; }

  /* ── Typography ── */
  .hero-title {
    font-size: clamp(72px, 12vw, 160px); font-weight: 900; letter-spacing: -4px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    line-height: 1; margin-bottom: 20px;
  }
  .hero-sub {
    font-size: clamp(16px, 2.5vw, 24px); color: var(--text-3); font-weight: 300;
    letter-spacing: 2px; text-transform: uppercase;
    opacity: 0; transition: opacity 1.2s ease 0.6s;
  }
  .hero-sub.show { opacity: 1; }

  .scene-label {
    font-size: 11px; text-transform: uppercase; letter-spacing: 4px; font-weight: 600;
    color: var(--text-3); margin-bottom: 32px;
  }
  .big-num {
    font-family: var(--mono); font-size: clamp(48px, 10vw, 120px); font-weight: 800;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    line-height: 1; margin-bottom: 8px;
  }
  .big-unit {
    font-size: clamp(20px, 3vw, 36px); font-weight: 300; color: var(--text-2);
    margin-bottom: 24px;
  }
  .scene-line {
    font-size: clamp(14px, 2vw, 20px); color: var(--text-3); line-height: 1.8;
    max-width: 680px; text-align: center;
    opacity: 0; transform: translateY(12px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  .scene-line.show { opacity: 1; transform: translateY(0); }
  .scene-line strong { color: var(--text); font-weight: 600; }

  /* ── Stat grid ── */
  .stat-row {
    display: flex; gap: 32px; margin-bottom: 24px; flex-wrap: wrap; justify-content: center;
  }
  .stat-block {
    text-align: center; opacity: 0; transform: translateY(16px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  .stat-block.show { opacity: 1; transform: translateY(0); }
  .stat-val {
    font-family: var(--mono); font-size: clamp(28px, 5vw, 56px); font-weight: 700;
    color: var(--text); line-height: 1.1;
  }
  .stat-val.purple { background: linear-gradient(135deg,var(--accent),var(--accent2)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
  .stat-desc {
    font-size: 12px; color: var(--text-3); text-transform: uppercase;
    letter-spacing: 2px; margin-top: 6px;
  }

  /* ── Loss curve ── */
  .loss-canvas { border-radius: 12px; display: block; max-width: 600px; width: 100%; }

  /* ── Similarity reveal ── */
  .sim-reveal {
    display: flex; align-items: center; gap: 24px; margin-bottom: 16px;
    opacity: 0; transform: translateX(-16px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  .sim-reveal.show { opacity: 1; transform: translateX(0); }
  .sim-word { font-family: var(--mono); font-size: 20px; color: var(--text); min-width: 80px; text-align: center; }
  .sim-arrow { color: var(--text-3); font-size: 16px; }
  .sim-score { font-family: var(--mono); font-size: 28px; font-weight: 700; }
  .sim-score.zero { color: var(--accent2); }
  .sim-score.high { color: var(--green); }

  /* ── Head tiles ── */
  .head-tiles { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; max-width: 700px; }
  .head-tile {
    width: 44px; height: 44px; border-radius: 8px; display: flex; align-items: center; justify-content: center;
    font-family: var(--mono); font-size: 11px; font-weight: 600;
    opacity: 0; transform: scale(0.5);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
  .head-tile.show { opacity: 1; transform: scale(1); }

  /* ── Layer flow ── */
  .layer-flow { display: flex; align-items: center; gap: 0; max-width: 700px; overflow: hidden; }
  .layer-node {
    display: flex; flex-direction: column; align-items: center; gap: 4px;
    opacity: 0; transition: opacity 0.3s ease;
    min-width: 20px;
  }
  .layer-node.show { opacity: 1; }
  .layer-dot { width: 10px; height: 10px; border-radius: 50%; }
  .layer-connector { width: 6px; height: 2px; background: var(--text-3); flex-shrink: 0; opacity: 0; transition: opacity 0.2s ease; }
  .layer-connector.show { opacity: 1; }

  /* ── End card grid ── */
  .end-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
    max-width: 500px; width: 100%; margin-top: 32px;
  }
  .end-cell {
    background: var(--card); border: 1px solid var(--border); border-radius: 10px;
    padding: 16px; text-align: center;
    opacity: 0; transform: translateY(8px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  .end-cell.show { opacity: 1; transform: translateY(0); }
  .end-cell-val { font-family: var(--mono); font-size: 20px; font-weight: 700; color: var(--text); }
  .end-cell-label { font-size: 10px; color: var(--text-3); text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; }

  /* ── Pipeline steps ── */
  .pipe-flow { display: flex; align-items: center; gap: 0; flex-wrap: wrap; justify-content: center; }
  .pipe-node {
    padding: 14px 20px; border-radius: 10px; text-align: center;
    opacity: 0; transform: translateX(-12px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  .pipe-node.show { opacity: 1; transform: translateX(0); }
  .pipe-node.done { background: var(--card); border: 1px solid var(--border); }
  .pipe-node.next { background: transparent; border: 1px dashed #333; }
  .pipe-node-name { font-size: 14px; font-weight: 600; color: var(--text); }
  .pipe-node-detail { font-size: 10px; color: var(--text-3); margin-top: 2px; }
  .pipe-sep { color: var(--text-3); font-size: 16px; padding: 0 8px; opacity: 0; transition: opacity 0.3s ease; }
  .pipe-sep.show { opacity: 1; }

  /* ── Controls ── */
  .controls {
    position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
    background: rgba(0,0,0,0.85); backdrop-filter: blur(20px);
    border-top: 1px solid var(--border); padding: 14px 32px;
    display: flex; align-items: center; gap: 16px;
  }
  .play-btn {
    width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--border);
    background: var(--card); color: var(--text); cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px; transition: all 0.2s;
  }
  .play-btn:hover { border-color: var(--accent); }
  .timeline-wrap { flex: 1; position: relative; height: 6px; cursor: pointer; }
  .timeline-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #1a1a1a; border-radius: 3px; }
  .timeline-fill { position: absolute; top: 0; left: 0; height: 100%; border-radius: 3px; background: linear-gradient(90deg, var(--accent), var(--accent2)); transition: width 0.3s ease; }
  .timeline-dots { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; }
  .timeline-dot {
    width: 8px; height: 8px; border-radius: 50%; background: #333;
    position: absolute; transform: translateX(-50%);
    transition: background 0.3s;
  }
  .timeline-dot.past { background: var(--accent); }
  .time-label { font-family: var(--mono); font-size: 11px; color: var(--text-3); min-width: 80px; text-align: right; }

  /* ── Glow effects ── */
  .glow {
    position: absolute; border-radius: 50%; pointer-events: none;
    filter: blur(80px); opacity: 0.15;
  }
  .glow-purple { background: var(--accent); }
  .glow-pink { background: var(--accent2); }
</style>
</head>
<body>

<div id="stage"></div>

<div class="controls">
  <button class="play-btn" id="playBtn">&#9646;&#9646;</button>
  <div class="timeline-wrap" id="timeline">
    <div class="timeline-bg"></div>
    <div class="timeline-fill" id="timelineFill"></div>
    <div class="timeline-dots" id="timelineDots"></div>
  </div>
  <div class="time-label" id="timeLabel">1 / 12</div>
</div>

<script>
/* ═════════════════════════════════════════════════════ */
/* jllm Journey — Cinematic Auto-Play                   */
/* All data from real jllm model (1.68B, 26 layers)     */
/* ═════════════════════════════════════════════════════ */

var TOTAL = 12;
var SCENE_DURATION = 5000;
var FADE_DURATION = 800;
var current = 0;
var playing = true;
var timer = null;

/* ── DOM helpers ── */
function $(id) { return document.getElementById(id); }
function el(tag, cls, text) {
  var e = document.createElement(tag);
  if (cls) e.className = cls;
  if (text !== undefined) e.textContent = text;
  return e;
}

/* ── Counter animation ── */
function animateCount(element, target, duration, prefix, suffix) {
  prefix = prefix || "";
  suffix = suffix || "";
  var start = performance.now();
  var isFloat = target !== Math.floor(target);
  function tick(now) {
    var p = Math.min((now - start) / duration, 1);
    p = 1 - Math.pow(1 - p, 3); /* ease-out cubic */
    var val = target * p;
    element.textContent = prefix + (isFloat ? val.toFixed(1) : Math.floor(val).toLocaleString()) + suffix;
    if (p < 1) requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

/* ── Stagger reveal ── */
function stagger(parent, selector, baseDelay) {
  var items = parent.querySelectorAll(selector);
  for (var i = 0; i < items.length; i++) {
    (function(el, delay) {
      setTimeout(function() { el.classList.add("show"); }, delay);
    })(items[i], baseDelay + i * 200);
  }
}

/* ── Build scenes ── */
var scenes = [];
var stage = $("stage");

function buildScene(buildFn) {
  var s = el("div", "scene");
  buildFn(s);
  stage.appendChild(s);
  scenes.push(s);
}

/* ── 1. Title ── */
buildScene(function(s) {
  var g1 = el("div", "glow glow-purple");
  g1.style.cssText = "width:400px;height:400px;top:20%;left:30%;";
  s.appendChild(g1);
  var g2 = el("div", "glow glow-pink");
  g2.style.cssText = "width:300px;height:300px;bottom:30%;right:25%;";
  s.appendChild(g2);
  s.appendChild(el("div", "hero-title", "jllm"));
  var sub = el("div", "hero-sub", "Building a language model from scratch");
  s.appendChild(sub);
  s._onEnter = function() {
    setTimeout(function() { sub.classList.add("show"); }, 100);
  };
});

/* ── 2. The Data ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "The Data"));
  var num = el("div", "big-num", "0");
  s.appendChild(num);
  s.appendChild(el("div", "big-unit", "shards of training data"));
  var l1 = el("div", "scene-line", "");
  var l1b = document.createTextNode("33 GB of raw text from ");
  var l1s = el("strong", null, "FineWeb");
  l1.appendChild(l1b); l1.appendChild(l1s);
  s.appendChild(l1);
  var l2 = el("div", "scene-line", "Roughly 6.6 billion words. Millions of web pages.");
  l2.style.transitionDelay = "0.4s";
  s.appendChild(l2);
  var l3 = el("div", "scene-line", "Not curated. Not labeled. Just the internet.");
  l3.style.transitionDelay = "0.8s";
  s.appendChild(l3);
  s._onEnter = function() {
    animateCount(num, 370, 2000);
    setTimeout(function() { l1.classList.add("show"); }, 600);
    setTimeout(function() { l2.classList.add("show"); }, 1000);
    setTimeout(function() { l3.classList.add("show"); }, 1400);
  };
});

/* ── 3. The Tokenizer ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "The Tokenizer"));
  var num = el("div", "big-num", "0");
  s.appendChild(num);
  s.appendChild(el("div", "big-unit", "BPE merges"));

  var row = el("div", "stat-row");
  var s1 = el("div", "stat-block");
  s1.appendChild(el("div", "stat-val", "92"));
  s1.appendChild(el("div", "stat-desc", "bytes in"));
  row.appendChild(s1);
  var arrow = el("div", "stat-block");
  var arrowVal = el("div", "stat-val", "\u2192");
  arrowVal.style.color = "var(--text-3)";
  arrow.appendChild(arrowVal);
  arrow.appendChild(el("div", "stat-desc", ""));
  row.appendChild(arrow);
  var s2 = el("div", "stat-block");
  s2.appendChild(el("div", "stat-val purple", "14"));
  s2.appendChild(el("div", "stat-desc", "tokens out"));
  row.appendChild(s2);
  s.appendChild(row);

  var l1 = el("div", "scene-line", "6.6\u00d7 compression. Every word encoded as integers.");
  s.appendChild(l1);

  s._onEnter = function() {
    animateCount(num, 32768, 2000);
    stagger(s, ".stat-block", 800);
    setTimeout(function() { l1.classList.add("show"); }, 1400);
  };
});

/* ── 4. The Architecture ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "The Architecture"));
  var num = el("div", "big-num", "0");
  s.appendChild(num);
  s.appendChild(el("div", "big-unit", "parameters"));

  var row = el("div", "stat-row");
  row.style.marginTop = "12px";
  var specs = [
    {v:"26",d:"layers"},{v:"13",d:"heads / layer"},{v:"1,664",d:"dimensions"},{v:"128",d:"head dim"}
  ];
  specs.forEach(function(sp) {
    var b = el("div", "stat-block");
    b.appendChild(el("div", "stat-val", sp.v));
    b.appendChild(el("div", "stat-desc", sp.d));
    row.appendChild(b);
  });
  s.appendChild(row);

  var l1 = el("div", "scene-line", "Rotary embeddings. QK normalization. Flash Attention 3. ReLU\u00b2.");
  s.appendChild(l1);

  s._onEnter = function() {
    animateCount(num, 1.68, 2200, "", "B");
    stagger(s, ".stat-block", 600);
    setTimeout(function() { l1.classList.add("show"); }, 1800);
  };
});

/* ── 5. The Hardware ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "The Hardware"));

  var row = el("div", "stat-row");
  var s1 = el("div", "stat-block");
  s1.appendChild(el("div", "stat-val purple", "8\u00d7"));
  s1.appendChild(el("div", "stat-desc", "NVIDIA H100"));
  row.appendChild(s1);
  var s2 = el("div", "stat-block");
  s2.appendChild(el("div", "stat-val", "80 GB"));
  s2.appendChild(el("div", "stat-desc", "per GPU"));
  row.appendChild(s2);
  s.appendChild(row);

  var row2 = el("div", "stat-row");
  row2.style.marginTop = "16px";
  var hw = [{v:"640 GB",d:"total VRAM"},{v:"1.7 TB",d:"system RAM"},{v:"104",d:"CPU cores"}];
  hw.forEach(function(h) {
    var b = el("div", "stat-block");
    b.appendChild(el("div", "stat-val", h.v));
    b.appendChild(el("div", "stat-desc", h.d));
    row2.appendChild(b);
  });
  s.appendChild(row2);

  var l1 = el("div", "scene-line", "Lambda Cloud. One machine. Enough compute to rival a small data center.");
  s.appendChild(l1);

  s._onEnter = function() {
    stagger(s, ".stat-block", 300);
    setTimeout(function() { l1.classList.add("show"); }, 1600);
  };
});

/* ── 6. The Training ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "The Training"));

  var row = el("div", "stat-row");
  var s1 = el("div", "stat-block");
  var s1v = el("div", "stat-val purple", "0");
  s1.appendChild(s1v);
  s1.appendChild(el("div", "stat-desc", "steps"));
  row.appendChild(s1);
  var s2 = el("div", "stat-block");
  var s2v = el("div", "stat-val purple", "0");
  s2.appendChild(s2v);
  s2.appendChild(el("div", "stat-desc", "hours"));
  row.appendChild(s2);
  s.appendChild(row);

  /* Mini loss curve */
  var cWrap = el("div", "");
  cWrap.style.cssText = "margin:20px 0;opacity:0;transition:opacity 0.8s ease 1s;";
  var canvas = document.createElement("canvas");
  canvas.className = "loss-canvas";
  canvas.width = 600; canvas.height = 160;
  cWrap.appendChild(canvas);
  s.appendChild(cWrap);

  var l1 = el("div", "scene-line", "From random noise to GPT-2 level. In one sitting.");
  s.appendChild(l1);

  s._onEnter = function() {
    animateCount(s1v, 7226, 2500);
    animateCount(s2v, 2.5, 2500);
    stagger(s, ".stat-block", 200);
    setTimeout(function() { cWrap.style.opacity = "1"; }, 400);
    setTimeout(function() { l1.classList.add("show"); }, 2000);

    /* Draw loss curve */
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "#0a0a0a";
    ctx.fillRect(0, 0, 600, 160);

    /* Approximate jllm loss curve: starts ~11, drops fast, settles ~3.2 */
    var pts = [];
    for (var i = 0; i <= 100; i++) {
      var t = i / 100;
      var loss = 3.2 + 7.8 * Math.exp(-4 * t) + 0.3 * Math.sin(t * 20) * Math.exp(-2 * t);
      pts.push({x: 30 + t * 540, y: 15 + (1 - (loss - 3) / 8.5) * 125});
    }

    /* Animate drawing */
    var drawn = 0;
    function drawFrame() {
      if (drawn >= pts.length - 1) return;
      var batchEnd = Math.min(drawn + 3, pts.length - 1);
      ctx.strokeStyle = "#a855f7";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(pts[drawn].x, pts[drawn].y);
      for (var j = drawn + 1; j <= batchEnd; j++) {
        ctx.lineTo(pts[j].x, pts[j].y);
      }
      ctx.stroke();
      drawn = batchEnd;
      requestAnimationFrame(drawFrame);
    }
    /* Axes */
    ctx.strokeStyle = "#222";
    ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(30, 15); ctx.lineTo(30, 140); ctx.lineTo(570, 140); ctx.stroke();
    ctx.fillStyle = "#555"; ctx.font = "10px Inter";
    ctx.fillText("Loss", 2, 12);
    ctx.fillText("Step", 560, 155);
    ctx.fillText("0", 30, 155);
    ctx.fillText("7,226", 530, 155);

    setTimeout(drawFrame, 800);
  };
});

/* ── 7. What It Learned: Tokens ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "What It Learned"));

  var l0 = el("div", "scene-line", "");
  l0.style.cssText = "font-size:clamp(24px,4vw,40px);font-weight:700;color:var(--text);margin-bottom:24px;opacity:0;transform:translateY(12px);transition:opacity 0.6s,transform 0.6s;";
  l0.textContent = "Tokenization";
  s.appendChild(l0);

  /* Show real tokens */
  var tokRow = el("div", "");
  tokRow.style.cssText = "display:flex;flex-wrap:wrap;gap:8px;justify-content:center;max-width:700px;margin-bottom:24px;";
  var toks = [
    {t:"The",c:"#a855f7"},{t:"\u00b7mode",c:"#ec4899"},{t:"\u00b7of",c:"#3b82f6"},
    {t:"\u00b7transportation",c:"#22c55e"},{t:"\u00b7is",c:"#f59e0b"},{t:"\u00b7an",c:"#a855f7"},
    {t:"\u00b7important",c:"#ec4899"},{t:"\u00b7consideration",c:"#3b82f6"},{t:"\u00b7when",c:"#22c55e"},
    {t:"\u00b7planning",c:"#f59e0b"},{t:"\u00b7the",c:"#a855f7"},{t:"\u00b7shipment",c:"#ec4899"},
    {t:"\u00b7process",c:"#3b82f6"},{t:".",c:"#22c55e"}
  ];
  toks.forEach(function(tok, i) {
    var box = el("div", "", tok.t);
    box.style.cssText = "font-family:var(--mono);font-size:14px;padding:8px 14px;border-radius:8px;border:1px solid " + tok.c + "30;background:" + tok.c + "15;color:" + tok.c + ";opacity:0;transform:translateY(8px);transition:opacity 0.4s ease " + (0.6 + i * 0.08) + "s,transform 0.4s ease " + (0.6 + i * 0.08) + "s;";
    tokRow.appendChild(box);
    s["_tok" + i] = box;
  });
  s.appendChild(tokRow);

  var l1 = el("div", "scene-line", "32,768 tokens. The alphabet jllm reads in.");
  s.appendChild(l1);

  s._onEnter = function() {
    setTimeout(function() { l0.style.opacity = "1"; l0.style.transform = "translateY(0)"; }, 100);
    for (var i = 0; i < toks.length; i++) {
      s["_tok" + i].style.opacity = "1";
      s["_tok" + i].style.transform = "translateY(0)";
    }
    setTimeout(function() { l1.classList.add("show"); }, 1800);
  };
});

/* ── 8. What It Learned: Embeddings ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "What It Learned"));

  var l0 = el("div", "scene-line", "");
  l0.style.cssText = "font-size:clamp(24px,4vw,40px);font-weight:700;color:var(--text);margin-bottom:32px;opacity:0;transform:translateY(12px);transition:opacity 0.6s,transform 0.6s;";
  l0.textContent = "Embeddings";
  s.appendChild(l0);

  /* Similarity pairs */
  var pairs = [
    {w1:"cat", w2:"dog", score:"0.000", cls:"zero"},
    {w1:"man", w2:"woman", score:"\u22120.013", cls:"zero"},
    {w1:"good", w2:"great", score:"\u22120.053", cls:"zero"},
    {w1:"The", w2:"the", score:"0.770", cls:"high"}
  ];
  var pairContainer = el("div", "");
  pairContainer.style.cssText = "margin-bottom:24px;";
  pairs.forEach(function(p, i) {
    var row = el("div", "sim-reveal");
    row.style.transitionDelay = (0.6 + i * 0.3) + "s";
    row.appendChild(el("div", "sim-word", p.w1));
    row.appendChild(el("div", "sim-arrow", "\u2194"));
    row.appendChild(el("div", "sim-word", p.w2));
    row.appendChild(el("div", "sim-arrow", "="));
    row.appendChild(el("div", "sim-score " + p.cls, p.score));
    pairContainer.appendChild(row);
  });
  s.appendChild(pairContainer);

  var l1 = el("div", "scene-line", "");
  var t1 = document.createTextNode("Raw embeddings have ");
  var s1 = el("strong", null, "no semantic meaning");
  var t2 = document.createTextNode(". That comes next.");
  l1.appendChild(t1); l1.appendChild(s1); l1.appendChild(t2);
  l1.style.transitionDelay = "1.8s";
  s.appendChild(l1);

  s._onEnter = function() {
    setTimeout(function() { l0.style.opacity = "1"; l0.style.transform = "translateY(0)"; }, 100);
    stagger(s, ".sim-reveal", 400);
    setTimeout(function() { l1.classList.add("show"); }, 1800);
  };
});

/* ── 9. What It Learned: Attention ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "What It Learned"));

  var l0 = el("div", "scene-line", "");
  l0.style.cssText = "font-size:clamp(24px,4vw,40px);font-weight:700;color:var(--text);margin-bottom:28px;opacity:0;transform:translateY(12px);transition:opacity 0.6s,transform 0.6s;";
  l0.textContent = "Attention";
  s.appendChild(l0);

  /* 13 head tiles */
  var tiles = el("div", "head-tiles");
  var headColors = [
    "#a855f7","#ec4899","#3b82f6","#22c55e","#f59e0b","#06b6d4","#8b5cf6",
    "#f43f5e","#10b981","#6366f1","#d946ef","#14b8a6","#f97316"
  ];
  for (var h = 0; h < 13; h++) {
    var tile = el("div", "head-tile", h.toString());
    tile.style.cssText += "background:" + headColors[h] + "20;border:1px solid " + headColors[h] + "40;color:" + headColors[h] + ";transition-delay:" + (0.8 + h * 0.08) + "s;";
    tiles.appendChild(tile);
  }
  s.appendChild(tiles);

  var l1 = el("div", "scene-line", "13 heads. 13 jobs. Nobody programmed them.");
  l1.style.cssText += "margin-top:24px;transition-delay:2s;";
  s.appendChild(l1);

  var l2 = el("div", "scene-line", "");
  var t1 = document.createTextNode("Copy heads. Content anchors. Topic finders. ");
  var s1 = el("strong", null, "All emergent.");
  l2.appendChild(t1); l2.appendChild(s1);
  l2.style.transitionDelay = "2.5s";
  s.appendChild(l2);

  s._onEnter = function() {
    setTimeout(function() { l0.style.opacity = "1"; l0.style.transform = "translateY(0)"; }, 100);
    stagger(s, ".head-tile", 600);
    setTimeout(function() { l1.classList.add("show"); }, 1800);
    setTimeout(function() { l2.classList.add("show"); }, 2400);
  };
});

/* ── 10. The Layer Journey ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "26 Layers of Self-Discovery"));

  /* Three phase labels */
  var phases = [
    {label:"Semantic", desc:"\"What is this about?\"", color:"#a855f7", delay:0.4},
    {label:"Identity", desc:"\"What am I?\"", color:"#ec4899", delay:1.2},
    {label:"Structure", desc:"\"How do I fit?\"", color:"#3b82f6", delay:2.0}
  ];

  phases.forEach(function(ph) {
    var block = el("div", "stat-block");
    block.style.cssText += "margin-bottom:20px;transition-delay:" + ph.delay + "s;";
    var val = el("div", "stat-val", ph.label);
    val.style.color = ph.color;
    val.style.fontSize = "clamp(28px,5vw,48px)";
    block.appendChild(val);
    block.appendChild(el("div", "stat-desc", ph.desc));
    s.appendChild(block);
  });

  var l1 = el("div", "scene-line", "");
  var t1 = document.createTextNode("Layer 0 explores meaning. Layer 12 consolidates identity. Layer 25 maps grammar. ");
  var s1 = el("strong", null, "Raw vectors become understanding.");
  l1.appendChild(t1); l1.appendChild(s1);
  l1.style.transitionDelay = "2.8s";
  s.appendChild(l1);

  s._onEnter = function() {
    stagger(s, ".stat-block", 400);
    setTimeout(function() { l1.classList.add("show"); }, 2800);
  };
});

/* ── 11. What's Next ── */
buildScene(function(s) {
  s.appendChild(el("div", "scene-label", "What Comes Next"));

  var pipe = el("div", "pipe-flow");
  var steps = [
    {name:"Data",detail:"33 GB",done:true},
    {name:"Tokenizer",detail:"32K vocab",done:true},
    {name:"Pretrain",detail:"7,226 steps",done:true},
    {name:"SFT",detail:"Conversations",done:false},
    {name:"Chat",detail:"Talk to jllm",done:false}
  ];
  steps.forEach(function(st, i) {
    if (i > 0) {
      var sep = el("div", "pipe-sep", "\u2192");
      sep.style.transitionDelay = (0.4 + i * 0.25) + "s";
      pipe.appendChild(sep);
    }
    var node = el("div", "pipe-node " + (st.done ? "done" : "next"));
    node.style.transitionDelay = (0.4 + i * 0.25) + "s";
    node.appendChild(el("div", "pipe-node-name", st.name));
    node.appendChild(el("div", "pipe-node-detail", st.detail));
    pipe.appendChild(node);
  });
  s.appendChild(pipe);

  var l1 = el("div", "scene-line", "");
  l1.style.cssText += "margin-top:32px;transition-delay:2s;";
  var t1 = document.createTextNode("The base model is trained. Next: teach it to ");
  var s1 = el("strong", null, "talk");
  var t2 = document.createTextNode(".");
  l1.appendChild(t1); l1.appendChild(s1); l1.appendChild(t2);
  s.appendChild(l1);

  s._onEnter = function() {
    stagger(s, ".pipe-node", 300);
    stagger(s, ".pipe-sep", 300);
    setTimeout(function() { l1.classList.add("show"); }, 2000);
  };
});

/* ── 12. End Card ── */
buildScene(function(s) {
  var g1 = el("div", "glow glow-purple");
  g1.style.cssText = "width:500px;height:500px;top:10%;left:20%;";
  s.appendChild(g1);
  var g2 = el("div", "glow glow-pink");
  g2.style.cssText = "width:400px;height:400px;bottom:20%;right:15%;";
  s.appendChild(g2);

  s.appendChild(el("div", "hero-title", "jllm"));

  var grid = el("div", "end-grid");
  var cells = [
    {v:"1.68B",l:"parameters"},{v:"26",l:"layers"},{v:"13",l:"heads"},
    {v:"32K",l:"vocab"},{v:"1,664",l:"dimensions"},{v:"7,226",l:"steps"},
    {v:"8\u00d7H100",l:"GPUs"},{v:"2.5h",l:"training"},{v:"33 GB",l:"data"}
  ];
  cells.forEach(function(c, i) {
    var cell = el("div", "end-cell");
    cell.style.transitionDelay = (0.3 + i * 0.1) + "s";
    cell.appendChild(el("div", "end-cell-val", c.v));
    cell.appendChild(el("div", "end-cell-label", c.l));
    grid.appendChild(cell);
  });
  s.appendChild(grid);

  var byline = el("div", "scene-line", "Built by Josh.");
  byline.style.cssText += "margin-top:28px;font-size:14px;letter-spacing:3px;text-transform:uppercase;transition-delay:1.5s;";
  s.appendChild(byline);

  s._onEnter = function() {
    stagger(s, ".end-cell", 200);
    setTimeout(function() { byline.classList.add("show"); }, 1500);
  };
});

/* ── Timeline dots ── */
var dotsContainer = $("timelineDots");
for (var d = 0; d < TOTAL; d++) {
  var dot = el("div", "timeline-dot");
  dot.style.left = (d / (TOTAL - 1) * 100) + "%";
  dot.setAttribute("data-idx", d);
  dotsContainer.appendChild(dot);
}

/* ── Navigation ── */
function goTo(n) {
  if (n < 0 || n >= TOTAL) return;
  scenes[current].classList.remove("active");
  current = n;
  scenes[current].classList.add("active");
  if (scenes[current]._onEnter) scenes[current]._onEnter();

  /* Update UI */
  $("timelineFill").style.width = (current / (TOTAL - 1) * 100) + "%";
  $("timeLabel").textContent = (current + 1) + " / " + TOTAL;
  var dots = dotsContainer.querySelectorAll(".timeline-dot");
  for (var i = 0; i < dots.length; i++) {
    if (i <= current) dots[i].classList.add("past");
    else dots[i].classList.remove("past");
  }
}

function next() {
  if (current < TOTAL - 1) goTo(current + 1);
  else { playing = false; updatePlayBtn(); }
}

function scheduleNext() {
  if (timer) clearTimeout(timer);
  if (!playing) return;
  timer = setTimeout(function() {
    next();
    if (playing) scheduleNext();
  }, SCENE_DURATION);
}

function updatePlayBtn() {
  $("playBtn").textContent = playing ? "\u23F8" : "\u25B6";
}

/* ── Controls ── */
$("playBtn").addEventListener("click", function() {
  playing = !playing;
  updatePlayBtn();
  if (playing) {
    if (current === TOTAL - 1) goTo(0);
    scheduleNext();
  } else {
    if (timer) clearTimeout(timer);
  }
});

$("timeline").addEventListener("click", function(e) {
  var rect = this.getBoundingClientRect();
  var pct = (e.clientX - rect.left) / rect.width;
  var idx = Math.round(pct * (TOTAL - 1));
  goTo(Math.max(0, Math.min(TOTAL - 1, idx)));
  if (playing) scheduleNext();
});

document.addEventListener("keydown", function(e) {
  if (e.key === " ") {
    e.preventDefault();
    $("playBtn").click();
  } else if (e.key === "ArrowRight") {
    e.preventDefault();
    next();
    if (playing) scheduleNext();
  } else if (e.key === "ArrowLeft") {
    e.preventDefault();
    if (current > 0) goTo(current - 1);
    if (playing) scheduleNext();
  }
});

/* ── Start ── */
goTo(0);
scheduleNext();

</script>
</body>
</html>
